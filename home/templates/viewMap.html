{% extends 'base_map_1.html' %}
{% load static%} {% block content %}
<style>
    table,
    th,
    td {
        border-bottom: 1px solid #ddd;
        border-collapse: collapse;
        padding: 2px 3px;
        text-align: center;
    }

    th {
        font-weight: bold;
    }

    tr:hover {
        background-color: #c9dbe6;
    }

    #checkboxes {
        display: none;
        /* border: 1px #dadada solid; */
    }

    .slider {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 25px;
        background: #D3D3D3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
    }

    .slider:hover {
        opacity: 1;
    }

    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 25px;
        height: 25px;
        background: #FF0000;
        cursor: pointer;
    }

    .slider::-moz-range-thumb {
        width: 25px;
        height: 25px;
        background: #FF0000;
        cursor: pointer;
    }

    .sliderticks {
        display: flex;
        justify-content: space-between;
        padding: 0 10px;
    }

    .sliderticks p {
        position: relative;
        display: flex;
        justify-content: center;
        text-align: center;
        width: 1px;
        background: #D3D3D3;
        height: 10px;
        line-height: 40px;
        margin: 0 0 20px 0;
    }

    input[type="range"]::-moz-range-track {
        padding: 0 10px;
        background: repeating-linear-gradient(to right, #ccc, #ccc 10%, #000 10%, #000 11%, #ccc 11%, #ccc 20%);
    }

    #checkboxes3 label {
        display: block;
        text-align: left;
        margin: 10px;
    }

    #checkboxes3 {
        display: none;
        /* border: 1px #dadada solid; */
    }

    #checkboxes label {
        display: block;
        text-align: left;
        margin: 10px;
    }
    /* #checkboxes label:hover {
  background-color: #1e90ff;
} */

    #checkboxes2 label {
        display: block;
        text-align: left;
        margin: 10px;
    }

    #checkboxes2 {
        display: none;
        /* border: 1px #dadada solid; */
    }

    .btn {
        margin: 10px;
    }

    .border {
        padding: 6px 8px;
        border-style: groove;
        border-radius: 5px;
        margin: 20px;
    }

    .info {
        padding: 6px 8px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
    }

    .info h4 {
        margin: 0 0 5px;
        color: #777;
    }

    .table {
        border-collapse: collapse;
        padding: 50px;
        font-weight: bold;
        /* background:rgba(191, 149, 233, 0.473); */
    }
    /* css to customize Leaflet default styles  */

    .leaflet-popup-content-wrapper {
        background: rgba(0, 0, 0, 0.9);
        color: #ffffff;
    }

    .leaflet-popup-content {
        font-weight: bold;
    }

    h6 {
        color: blue;
    }

    .select {
        background-color: rgb(116, 109, 109);
        width: 40%;
        margin-left: 100px;
        ;
        color: white;
    }

    .select.highlight {
        background: rgb(0, 0, 0);
        color: white;
    }

    .circle {
        background-color: red;
        border-radius: 50%;
    }

    .table-legend {
        border-collapse: collapse;
        padding: 2px 3px;
        width: 100%;
        font-size: small;
        /* font-weight: bold; */
        background: #fff;
    }

    .info {
        padding: 6px 8px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: white;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
    }

    .info h4 {
        margin: 0 0 5px;
        color: #777;
    }

    .legend {
        line-height: 18px;
        color: #555;
    }

    .legend i {
        width: 18px;
        height: 18px;
        float: left;
        margin-right: 8px;
        opacity: 0.7;
    }
    .leaflet-popup-content-wrapper{
        background: white;
    }
</style>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

<div id="side-bar" style="background-color: rgba(255, 255, 255);">
    <!-- side-bar container -->


    <div class="mobileShow">

        <div style="text-align: center">
            <button style="display: inline-block ;position: relative; background: #000; opacity: 0.60;" id="closebutton" name="closebutton" class="btn btn-secondary"><span class="fa fa-bars"></span></button>
        </div>

    </div>
    <div class="border">
        {% csrf_token %}

        <div>

        <form action="map" method="POST" id="cate">

            <div class="tooltips" title="Please select the District">
                <select name="district__in" class='form-control mb-2 mt-2' id = "district">
                <option value=""> Select District</option>
                <option value="Ahmednagar">Ahmednagar</option>
                <option value="Akola">Akola</option>
                <option value="Amravati">Amravati</option>
                <option value="Aurangabad">Aurangabad</option>
                <option value="Beed">Beed</option>
                <option value="Bhandara">Bhandara</option>
                <option value="Buldana">Buldana</option>
                <option value="Chandrapur">Chandrapur</option>
                <option value="Gadchiroli">Gadchiroli</option>
                <option value="Gondia">Gondia</option>
                <option value="Hingoli">Hingoli</option>
                <option value="Jalgaon">Jalgaon</option>
                <option value="Jalna">Jalna</option>
                <option value="Kolhapur">Kolhapur</option>
                <option value="Latur">Latur</option>
                <option value="Mumbai City">Mumbai City</option>
                <option value="mumbai_suburb">Mumbai Suburban</option>
                <option value="Nagpur">Nagpur</option>
                <option value="Nanded">Nanded</option>
                <option value="Nashik">Nashik</option>
                <option value="Osmanabad">Osmanabad</option>
                <option value="Palghar">Palghar</option>
                <option value="Parbhani">Parbhani</option>
                <option value="Pune">Pune</option>
                <option value="Raigad">Raigad</option>
                <option value="Ratnagiri">Ratnagiri</option>
                <option value="Sangli">Sangli</option>
                <option value="Satara">Satara</option>
                <option value="Sindhudurg">Sindhudurg</option>
                <option value="Solapur North">Solapur North</option>
                <option value="Thane"> Thane</option>
                <option value="Wardha">Wardha</option>
                <option value="Washim">Washim</option>
                <option value="Yavatmal">Yavatmal</option>
                 </select>
          </div>



        <div class="tooltips" title="Please select the Maharashtra's Blocks" id="block">
              <select name="block_n__in" class='form-control mb-2 mt-2' id="block_s">
                <option value=""> Select Taluka </option>
                {% for i in taluka %}
                <option value="{{ i.block_n }}">{{ i.block_n }}</option>
                {% endfor %}
               </select>
        </div>

        <div class="tooltips" title="Please select the Maharashtra's Project" id="block">
            <select onchange="document.getElementById('cate_submit').click()" name="project__in" class='form-control mb-2 mt-2' id="project">
              <option value=""> Select Project </option>
              {% for i in project %}
              <option value="{{ i.project }}">{{ i.project }}</option>
              {% endfor %}
             </select>
      </div>
        
            <div class="dd-1">
                <select onchange="this.style.display='none';" class='form-control mb-2 mt-2' name="" id="category_1">
                    <option value="">Select</option>
                    <option value="agan_type">Anganwadi Type</option>
                    <option value="agancbuil_field">Anganwadi Construction</option>
                    <option value="aganc_forrent">Is Anganwadi Center on Rent ?</option>
                    <option value="yes_moveagan_govpre">If yes, then is it possible to move your Anganwadi Center to the nearest Government School or Government premises ?</option>
                    <option value="no_owner_agancbuil">If no, then What is the name of the owner of the place ?</option>
                    <option value="child_sitagan">Child sitting capacity of Anganwadi Center</option>
                    <option value="agan_fenc">Is Your Anganwadi Center Fenced ?</option>
                    <option value="child_weigh_material">Does your Anganwadi center have equipment to measure weight of small children ?</option>
                    <option value="child_weigh_mat_working">Is the weight machine for children, working ?</option>
                    <option value="adult_wtequip">Does your Anganwadi center have equipment to measure weight of adults ?</option>
                    <option value="adult_wteq_working">Is the weight machine for adults, working ?</option>
                    <option value="infant_meter">Does your Anganwadi center have equipment (Infantometer) to measure length of small children ?</option>
                    <option value="infant_meter_working">Is the Infantometer for children, working ?</option>
                    <option value="stadiometer">Does your Anganwadi center have any equipment (Stadiometer) to measure height ?</option>
                    <option value="stadm_working">Is Stadiometer working</option>
                    <option value="maint_repair_need">Does your AWC building needs care or repair</option>
                    <option value="agan_drinkwat_avail">Does your Anganwadi center have drinking water available throughout the year?</option>
                    <option value="agan_tap">Does your Anganwadi center have tap water connection?</option>
                    <option value="plumb_workcond">Is the tap connection in ON condition?</option>
                    <option value="toil_fac">Does your Anganwadi center have toilet facilities?</option>
                    <option value="toil_working">Is the toilet in working order?</option>
                    <option value="electricity_connection">Does your Anganwadi center have electricity connection? Is it in condition?</option>
                    <option value="solar_powersupply">Is your Anganwadi center powered by solar power?</option>
                    <option value="agan_tv">Does your Anganwadi Center have TV?</option>
                    <option value="tv_working">Is the TV in working condition?</option>
                    <option value="agan_back_field">Does your Anganwadi center have a courtyard garden?</option>
                    <option value="space_own_field">If not, does your Anganwadi center have its own space to create a backyard garden?</option>
                    <option value="vac_agan">Are there vacancies in your Anganwadi Centre?</option>
                    <option value="post_vac">Which of the following posts are vacant?</option>
                    <option value="post_vac_aw_worker">Which of the following posts are vacant?/Anganwadi Sevika</option>
                    <option value="post_vac_help">Which of the following posts are vacant?/Asst</option>
                    <option value="pro_fill_agan_post">Has the process of filling vacancies in this Anganwadi Center started? Vacancies ?/help</option>
                    <option value="child0_6monage">What is the total number of children aged 0-6 months in your Anganwadi?</option>
                    <option value="child6mon_field">What is the total number of children aged 6 months to 3 years in your Anganwadi?</option>
                    <option value="child3_6y">What is the total number of children aged 3 to 6 years in your Anganwadi?</option>
                    <option value="tot_no_child">Total number of children</option>
                    <option value="preg_moth_field">What is the total number of pregnant mothers in your Anganwadi?</option>
                    <option value="brestfeed_field">What is the total number of lactating mothers in your Anganwadi?</option>
                    <option value="preg_lact_field">Total number of pregnant and lactating mothers</option>
                    <option value="child_weigh_meas_agan_mar22">How many registered children have been weighed in your Anganwadi center in March 2022?</option>
                    <option value="child_heigh_meas_agan_mar22">How many registered children have their height measured in March 2022 in your Anganwadi Centre?</option>
                    <option value="no_suv_child_agan_Jan_mar22">What is the number of severely underweight (SUW) children registered in your Anganwadi center during January 2022-March 2022?</option>
                    <option value="no_suv_child_recthr_jan_mar22">What is the number of severely underweight (SUW) infants who received additional THR during January 2022-March 2022 in your Anganwadi center?</option>
                    <option value="child_sam_field">What is the number of acutely malnourished (SAM) children registered in your Anganwadi center during January 2022-March 2022?</option>
                </select>
            </div>
            <style>
                .txt{
                    visibility: hidden;
                    position: absolute;
                    z-index: 1;
                    margin-left: 5px;
                    background-color:#c9dbe6 ;
                    color: #000;
                    border:#000 1px solid;
                }
                .add_filter:hover .txt{
                    visibility: visible;
                }
                .cls_txt{
                    visibility: hidden;
                }
                .cls:hover .cls_txt{
                    visibility: visible;
                }
                
            </style>
            <div class="add_filter" style=" border-radius: 50%; color: green;">
                <i onclick="a()" class="fas fa-plus fa-3x"></i>
                <span class="txt">Add Filter</span>
            </div>
            
            <script>
                var opn = false;
                // document.getElementById("category_1").style.display='none'
                function a(){
                    var x=document.getElementById("category_1");
                    if(!opn){
                        
                        x.style.display='block';
                        // x.click()
                        // x.size = x.options.length;
                        opn = true
                    }else{
                        x.style.display='none';
                        opn = false
                    }
                }
            </script>

            <p id="selected_optn" >

            </p>


            <!-- <input type="hidden" name="cate1" value="" id="cate1"> -->

            <!-- <select name="cate_val1" style="display: none;" class='form-control mb-2 mt-2' id="cate_val1">
                <option value=""></option>
            </select> -->

            <!-- <p id="chk-1"> -->
                <!-- <input type="checkbox" class="" name="agan_type__in" value="मुख्य" id=""><label class="mx-2" for="">dfsdf</label><br>
                <input type="checkbox" name="agan_type__in" value="मिनी" id=""><br> -->
            <!-- </p> -->




            <!-- <div class="dd-2">
                <select class='form-control mb-2 mt-2' name="" id="category_2">
                    <option value="">Select from Category 2</option>
                    <option value="child_weigh_material">Does your Anganwadi center have equipment to measure weight of small children ?</option>
                    <option value="child_weigh_mat_working">Is the weight machine for children, working ?</option>
                    <option value="adult_wtequip">Does your Anganwadi center have equipment to measure weight of adults ?</option>
                    <option value="adult_wteq_working">Is the weight machine for adults, working ?</option>
                    <option value="infant_meter">Does your Anganwadi center have equipment (Infantometer) to measure length of small children ?</option>
                    <option value="infant_meter_working">Is the Infantometer for children, working ?</option>
                    <option value="stadiometer">Does your Anganwadi center have any equipment (Stadiometer) to measure height ?</option>
                    <option value="stadm_working">Is Stadiometer working</option>
                    <option value="maint_repair_need">Does your AWC building needs care or repair</option>
                    <option value="agan_drinkwat_avail">Does your Anganwadi center have drinking water available throughout the year?</option>
                    <option value="agan_tap">Does your Anganwadi center have tap water connection?</option>
                    <option value="plumb_workcond">Is the tap connection in ON condition?</option>
                    <option value="toil_fac">Does your Anganwadi center have toilet facilities?</option>
                    <option value="toil_working">Is the toilet in working order?</option>
                    <option value="electricity_connection">Does your Anganwadi center have electricity connection? Is it in condition?</option>
                    <option value="solar_powersupply">Is your Anganwadi center powered by solar power?</option>
                    <option value="agan_tv">Does your Anganwadi Center have TV?</option>
                    <option value="tv_working">Is the TV in working condition?</option>
                    <option value="agan_back_field">Does your Anganwadi center have a courtyard garden?</option>
                    <option value="space_own_field">If not, does your Anganwadi center have its own space to create a backyard garden?</option>

                </select>
            </div> -->

            <!-- <input type="hidden" name="cate2" value="" id="cate2">

            <select name="cate_val2" style="display: none;" class='form-control mb-2 mt-2' id="cate_val2">
                <option value=""></option>
              </select> -->

              <!-- <p id="chk-2"> -->
                <!-- <input type="checkbox" class="" name="agan_type__in" value="मुख्य" id=""><label class="mx-2" for="">dfsdf</label><br>
                <input type="checkbox" name="agan_type__in" value="मिनी" id=""><br> -->
            <!-- </p> -->

            <!-- <div class="dd-1">
                <select class='form-control mb-2 mt-2' name="" id="category_3">
                    <option value="">Select from Category 3</option>
                    <option value="vac_agan">Are there vacancies in your Anganwadi Centre?</option>
                    <option value="post_vac">Which of the following posts are vacant?</option>
                    <option value="post_vac_aw_worker">Which of the following posts are vacant?/Anganwadi Sevika</option>
                    <option value="post_vac_help">Which of the following posts are vacant?/Asst</option>
                    <option value="pro_fill_agan_post">Has the process of filling vacancies in this Anganwadi Center started? Vacancies ?/help</option>
                    <option value="child0_6monage">What is the total number of children aged 0-6 months in your Anganwadi?</option>
                    <option value="child6mon_field">What is the total number of children aged 6 months to 3 years in your Anganwadi?</option>
                    <option value="child3_6y">What is the total number of children aged 3 to 6 years in your Anganwadi?</option>
                    <option value="tot_no_child">Total number of children</option>
                    <option value="preg_moth_field">What is the total number of pregnant mothers in your Anganwadi?</option>
                    <option value="brestfeed_field">What is the total number of lactating mothers in your Anganwadi?</option>
                    <option value="preg_lact_field">Total number of pregnant and lactating mothers</option>
                    <option value="child_weigh_meas_agan_mar22">How many registered children have been weighed in your Anganwadi center in March 2022?</option>
                    <option value="child_heigh_meas_agan_mar22">How many registered children have their height measured in March 2022 in your Anganwadi Centre?</option>
                    <option value="no_suv_child_agan_Jan_mar22">What is the number of severely underweight (SUW) children registered in your Anganwadi center during January 2022-March 2022?</option>
                    <option value="no_suv_child_recthr_jan_mar22">What is the number of severely underweight (SUW) infants who received additional THR during January 2022-March 2022 in your Anganwadi center?</option>
                    <option value="child_sam_field">What is the number of acutely malnourished (SAM) children registered in your Anganwadi center during January 2022-March 2022?</option>

                </select>
            </div> -->
            <!-- <input type="hidden" name="cate3" value="" id="cate3">

            <select name="cate_val3" style="display: none;" class='form-control mb-2 mt-2' id="cate_val3">
                <option value=""></option>
              </select> -->

              <!-- <p id="chk-3"> -->
                <!-- <input type="checkbox" class="" name="agan_type__in" value="मुख्य" id=""><label class="mx-2" for="">dfsdf</label><br>
                <input type="checkbox" name="agan_type__in" value="मिनी" id=""><br> -->
            <!-- </p> -->

            <button hidden id="cate_submit" type="submit" class="btn btn-primary">submit</button>
        </form>
    </div>


    <form method="POST" id="post-form">
        <!-- <div class="tooltips" title="Please select the District">
              <select name="district" class='form-control' id = "district">
                <option value="Select District"> Select District</option>
                {% for i in district %}
                <option value="{{ i.district }}">{{ i.district }}</option>
                {% endfor %}
               </select>
        </div>



       <div class="tooltips" title="Please select the Maharashtra's Blocks" id="block">
        &nbsp;&nbsp;
            <select name="taluka" class='form-control' id="block_s">
              <option value="Select Taluka"> Select Taluka </option>
              {% for i in taluka %}
              <option value="{{ i.block_n }}">{{ i.block_n }}</option>
              {% endfor %}
             </select>
      </div>  -->


      <div class="selected_dd">

        <input type="hidden" name="cate1" value="" id="cate1">
        <input type="hidden" name="cate2" value="" id="cate2">
        <input type="hidden" name="cate3" value="" id="cate3">

        <input type="hidden" name="cate_val1" value="" id="">
        <!-- <input type="hidden" name="cate_val1" id="">
        <input type="hidden" name="cate_val1" id=""> -->

          <!-- <select name="cate_val1" style="display: none;" class='form-control mb-2 mt-2' id="cate_val1">
            <option value=""></option>
          </select> -->
          <!-- <select name="cate_val2" style="display: none;" class='form-control mb-2 mt-2' id="cate_val2">
            <option value=""></option>
          </select> -->
          <!-- <select name="cate_val3" style="display: none;" class='form-control mb-2 mt-2' id="cate_val3">
            <option value=""></option>
          </select>    -->

      </div>


    </div>

    <!-- <div style="margin:20px" class="border">
        <select name="agan_type" class='form-control' id = "agan_type">
            <option value="">Select type of Aganwadi</option>
            <option value="मुख्य">मुख्य</option>
            <option value="मिनी">मिनी</option>
        </select>



    </div> -->
    <!-- <div class="border">
        <div class="tooltips mb-3" title="Please select the Construction Type">
            <select name="constr" class='form-control' id = "construction">
              <option value=""> Select AWC Construction Type</option>
              <option value="अंगणवाडी इमारत नाही आहे">अंगणवाडी इमारत नाही आहे</option>
              <option value="कच्चे">कच्चे</option>
              <option value="पक्के">पक्के</option>
              {% comment %} <option value="d">d</option> {% endcomment %}
             </select>
      </div>
      <div class="tooltips" title="Please select the Angan">
        <select name="sitangan" class='form-control' id = "sitangan">
          <option value=""> Select Child Sit Angan</option>
          <option value="01-01-2020">01-01-2020</option>
          <option value="२१-४०">२१-४०</option>
          <option value="४१-६०">४१-६०</option>
          <option value="६०+">६०+</option>
         </select>
  </div>
    </div> -->

    <button hidden type="submit" id="fs" class="btn btn-primary">Plot Data</button>

</form>

    <button onclick="download()" id="down-data"class="btn btn-primary">Download Data</button>
    <button onclick="clearAll()" id="clear-data"class="btn btn-primary">Clear All</button>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>
    let isClicked = false

    var icon1 = L.icon({
        iconUrl:  "{% static 'map/pinmargerblue.png' %}",
        iconSize:     [30, 30], // size of the icon
        //shadowSize:   [50, 64], // size of the shadow
        iconAnchor:   [25,10], // point of the icon which will correspond to marker's location
        // shadowAnchor: [4, 62],  // the same for the shadow
        popupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor
    });

    var awcLayer = L.layerGroup().addTo(mymap);
    // awcLayer.addTo(mymap);

    </script>
      <style>
      .another-popup .leaflet-popup-content-wrapper .leaflet-popup-content{
          width: 400px;
          height:auto;
        }

      </style>

      <script>

var points=[];
var districtLayer;
var talLayer;

var Raigad = [ 'Select Taluka', 'Pen','Alibag','Murud','Panvel','Uran','Karjat','Khalapur','Mangaon']
var Ratnagiri = ['Select Taluka','Ratnagiri','Sangameshwar','Lanja','Rajapur ','Chiplun','Guhagar','Dapoli','Mandangad','Khed']
var Sindhudurg = ['Select Taluka','Kankavli','Vaibhavwadi','Devgad','Malwan','Sawantwadi','Kudal','Vengurla','Dodamarg (Kasal)']
var Palghar = ['Select Taluka','Palghar','Vasai','Dahanu','Talasari','Jawhar','Mokhada','Vada','Vikramgad']
var nashik  = ['Select Taluka', 'Nashik','Igatpuri','Dindori','Peth','Trimbakeshwar','Kalwan','Deola','Surgana','Baglan(Satana)','Malegaon','Nandagaon','Chandwad','Niphad','Sinnar','Yeola']
var Nandurbar = ['Select Taluka', 'Nandurbar','Navapur','Shahada','Talode','Akkalkuwa','Akrani(Dhadgaon)']
var Dhule= ['Select Taluka', 'Dhule','Sakri','Sindkheda','Shirpur']
var mumbai_suburb = ['Select Taluka','Kurla','Mulund','Andheri','Borivali']
var Mumbai_City = ['Select Taluka','Mumbai']
var Jalgaon = ['Select Taluka', 'Jalgaon','Jamner','Erandol','Dharangaon','Bhusawal','Raver','Muktainagar','Yawal','Amalner','Parola','Chopda','Pachora','Bhadgaon','Chalisgaon']
var Buldhana = ['Select Taluka', 'Buldana','Chikhli','Deulgaon','Jalgaon Jamod','Sangrampur','Malkapur','Motala','Nandura','Khamgaon','Shegaon','Mehkar','Sindkhed Raja','Lonar']
var Akola = ['Select Taluka', 'Akola','Akot','Telhara','Patur','Murtajapur','Barshitakli']
var Washim = ['Select Taluka', 'Wahim','Malegaon','Risod','Mangrulpir','Karanja','Manora']
var Thane=['Select Taluka','Thane','Kalyan','Murbad','Bhiwandi','shahapur','Ulhasnagar','Ambarnath']
var amravati = ['Select Taluka', 'Amravati','Bhatukali','Nandgaon Khandeshwar','Dharni (Amravati)','Chikhaldara','Achalpur','Chandurbazar','Morshi','Warud','Daryapur','Anjangaon-Surji','Chandur','Dhamangaon','Tiosa']
var Wardha = ['Select Taluka', '	Wardha','Deoli','Seloo','Arvi','Ashti','Karanja','Hinganghat','Samudrapur']
var nagpur = ['Select Taluka', 'Nagpur','Kamptee','Hingna','Katol','Narkhed','Savner','Kalameshwar','Ramtek','Mouda','Parseoni','Umred','Kuhi','Bhiwapur']
var Bhandara = ['Select Taluka', 'Bhandara','Tumsar','Pauni','Mohadi','Sakoli','Lakhni','Lakhandur']
var Gondia = ['Select Taluka', 'Gondia','Tiroda','Goregaon','Arjuni Morgaon','Amgaon','Salekasa','Sadak Arjuni ','Deori']
var gadchiroli = ['Select Taluka', 'Gadchiroli','Dhanora','Chamorshi','Mulchera','Desaiganj (Vadasa)','Armori','Kurkheda','Korchi','Korchi','Bhamragad','Sironcha']
var Chandrapur = ['Select Taluka', 'Chandrapur','Saoli','Mul','Ballarpur','Pombhurna','Gondpimpri','Warora','Chimur','Bhadravati','Bramhapuri','Nagbhid ','Sindewahi','Rajura','Korpana','Jivati']
var Yavatmal = ['Select Taluka', 'Yavatmal','Arni','Babhulgaon','Kalamb','Darwha','Digras','Ner','Pusad','Umarkhed','Mahagaon','Kelapur (Pandharkawada)','Ralegaon','Ghatanji','Wani','Maregaon','Zari Jamani']
var Nanded = ['Select Taluka', 'Nanded','Ardhapur','Mudkhed','Bhokar','Umri','Loha','Kandhar','Kinwat','Himayatnagar','Hadgaon','Mahur','Deglur','Mukhed','Dharmabad','Biloli','Naigaon (Khairgaon)']
var Hingoli = ['Select Taluka', 'Hingoli','Sengaon','Kalamnuri','Basmath','Aundha Nagnath']
var Parbhani = ['Select Taluka', 'Parbhani','Sonpeth','Gangakhed','Palam','Purna','Sailu','Jintur','Manwath','Pathri']
var Jalna = ['Select Taluka', 'Jalna','Bhokardan','Jafrabad','Badnapur','Ambad','Ghansawangi','Partur','Mantha']
var aurangabad = ['Select Taluka', 'Aurangabad','Kannad','Soegaon','Sillod','Phulambri','Khuldabad','Vaijapur','Gangapur','Paithan']
var Beed= ['Select Taluka', 'Beed','Ashti','Patoda','Shirur-Kasar','Georai','Majalgaon','Wadwani','Kaij','Dharur','Parli','Ambejogai']
var Latur = ['Select Taluka', 'Latur','Renapur','Ahmedpur','Jalkot','Chakur','Shirur Anantpal','Ausa','Nilanga','Deoni','	Udgir',]
var Osmanabad = ['Select Taluka', 'Osmanabad','Tuljapur','Bhum','Paranda','Washi','Kalamb','Lohara','Umarga']
var Solapur_North = ['Select Taluka', 'Solapur North','Barshi','Solapur South','Akkalkot','Madha','Karmala','Pandharpur','Mohol','Malshiras','Sangole','Mangalvedhe']
var Ahmednagar = ['Select Taluka', 'nagar','Shevgaon','Pathardi','Parner','Sangamner','Kopargaon','Akola','Shrirampur','Nevasa','Rahata','Rahuri','Shrigonda ','Karjat','Jamkhed']
var pune = ['Select Taluka', 'Pune City','Haveli','Haveli - PCMC, PCMC','Khed (Rajgurunagar)','Junnar','Ambegaon (Ghodegaon)','Maval (Vadgaon)','Mulshi (Paud)','Shirur','Purandhar (Saswad)','Velhe','Bhor','Baramati','Indapur','Daund']
var Satara = ['Select Taluka', 'Satara','Jaoli','Koregaon','Wai','Mahabaleshwar','Khandala','Phaltan','Maan (Dahiwadi)','Khatav (Vaduj)','Patan','Karad']
var Sangli = ['Select Taluka', 'Miraj','Kavathe-Mahankal','Tasgaon','Jat','Walwa (Islampur)','Shirala','Khanapur-Vita ','Atpadi','Palus','Kadegaon']
var Kolhapur = ['Select Taluka', 'Karvir','Panhala','Shahuwadi','Kagal','Hatkanangale','Shirol','Radhanagari','Gaganbawada','Bhudargad','Gadhinglaj','Chandgad','Ajra']


const download = ()=>{
    const rows = [['awc_code','district','project','beat','latitude','longitude','altitude','accuracy','objectid','st_code','st_name','dist_code','dist_name','ac_no','ac_name','start','end','division','district_1','project_2','Beat_3','Anganwadi_4','agan_type','agancbuil_const','aganc_forrent','yes_moveagan_govpre','no_owner_agancbuil','child_sitagan','child_weigh_material','child_weigh_mat_working','adult_wtequip','adult_wteq_working','infant_meter','infant_meter_working','stadiometer','stadm_working','maint_repair_need','agan_drinkwat_avail','agan_tap','plumb_workcond','toil_fac','toil_working','electricity_connection','solar_powersupply','agan_tv','tv_working','agan_fenc','agan_back_gard','space_own_garden','vac_agan','post_vac','post_vac_aw_worker','post_vac_help','pro_fill_agan_post','child0_6monage','child6mon_3yr','child3 _6yrs','tot_no_child','preg_moth_agan','brestfeed_moth_agan','preg_lact_moth','aadh_notlinknuttrack','preg_lact_mothaadh_notlinked_nuttrack','child_weigh_meas_agan_mar22','child_heigh_meas_agan_mar22','no_suv_child_agan_Jan_mar22','no_suv_child_recthr_jan_mar22','child_sam_agan_jan_mar22','child_rec_vcdc_fac','sam_child_agan_vcdc_jan_mar22','sam_agan_nrc_jan_mar22','no_adol_girl_dropsch_agan','child_agan_sch_engl_priv_nurs','ifyes_childenrol_agan_sch_priv_nurs_engl','agan_rec_migr_bene','bene_agan_migr_indist','agan_bene_migr_outdist','benetot_migr_out','migrbenetot_agancentarea','agan_serv_migr_outaganarea','ifyes_aganspen10pergdp_endmar22','ifyes_gp_spent_10pergdp_endmarch22','aay','totno_child_serv_aay_6mon_6yrs','preg_lact_mother_serv_aay_ecd','parvisit_inibalasch','parent_visit_past_year','balasch','agan_und_balasch','work_comund_balasch_mar22','ifcom_ongo_task_comp_undbalasch','ifcom_ongo_task_comp_undbalasch1','ifcom_ongo_task_comp_undbalasch_sandpit','ifcom_ongo_task_comp_undbalasch_lawn','ifcom_ongo_task_comp_undbalasch_display','ifcom_ongo_task_comp_undbalasch_writboar','sign_sup_chserv','sign_sup_headmisurl','_id','_uuid','_submission_time','_validation_status','_notes','_status','_submitted_by','_tags','_index']]
    for(point of points){
        const row=[]
        for(attr in point.data){
            row.push(point.data[attr])
        }
        rows.push(row);

    }
    console.log("rows for csv ",rows[1]);


    const bom = "\uFEFF"
    let csvContent = "data:text/csv;charset=utf-8," +bom+ rows.map(e => e.join(",")).join("\n");
    var encodedUri = encodeURI(csvContent);
    var link = document.createElement("a");
    link.setAttribute("href",encodedUri);
    link.setAttribute("download", "my_data.csv");
    document.body.appendChild(link); // Required for FF

    link.click();
}

var DistrictSelected="";
$("#district").change(function(){
    //document.getElementById('post-form').submit()
    //document.getElementById('cate').click()
    document.getElementById('cate_submit').click();
    DistrictSelected = $(this).val();
    var optionsList;
    var htmlString = "";

    if(districtLayer){
        mymap.removeLayer(districtLayer)
    }

var wms_layer;
var data = fetchJSON("{% static 'data/districts.geojson' %}")
    .then(function(data) { 

    // do what you want to do with `data` here...
    data.features.forEach(function(feature) {
        //console.log(feature.properties.Block)
        if(DistrictSelected!=""){
            //console.log(feature.properties)
            if(feature.properties.district==DistrictSelected){
                wms_layer = L.geoJson(feature.geometry)
                wms_layer.addTo(mymap)
                mymap.fitBounds(wms_layer.getBounds())
            }
        }
        districtLayer = wms_layer;
    });
    
});   

var input={} 

if(DistrictSelected!=""){
    input.district = DistrictSelected;
}

$.ajax({
    type:"GET",
    url: "{% url 'dist_proj' %}",
    dataType: 'json',
    data: {input},
    success: function(data){
        //console.log(data)
        //d = JSON.parse(data["data"])
        //console.log(data['c1'])
        var htm = "<option value=''> Select Project</option>"
        data.pp.forEach(e=>{
            htm=htm+`<option value='${e.project}'>${e.project}</option>`
        })
        $('#project').html(htm)

    }
})


    switch (DistrictSelected) {
      case "Raigad":
          optionsList = Raigad;
          break;
      case "Ratnagiri":
          optionsList = Ratnagiri;
          break;
      case "Sindhudurg":
          optionsList = Sindhudurg;
          break;
      case "mumbai_suburb":
          optionsList = mumbai_suburb;
          break;
      case "Mumbai City":
          optionsList = Mumbai_City;
          break;
      case "Thane":
          optionsList = Thane;
          break;
      case "Palghar":
          optionsList = Palghar;
          break;
      case "Nashik":
          optionsList = nashik;
          break;
      case "Nandurbar":
          optionsList = Nandurbar;
          break;
      case  "Dhule":
          optionsList = Dhule;
          break;
      case "Jalgaon":
          optionsList = Jalgaon;
          break;
      case "Buldana":
          optionsList = Buldana;
          break;
      case "Akola":
          optionsList = Akola;
          break;
      case "Washim":
          optionsList = Washim;
          break;
      case  "Amravati":
          optionsList = amravati;
          break;
      case "Wardha":
          optionsList = Wardha;
          break;
      case  "Nagpur":
          optionsList = nagpur;
          break;
      case "Bhandara":
          optionsList = Bhandara;
          break;
      case  "Gondia":
          optionsList = Gondia;
          break;
      case "Gadchiroli":
          optionsList = gadchiroli;
          break;
      case  "Chandrapur":
          optionsList = Chandrapur;
          break;
      case "Yavatmal":
          optionsList = Yavatmal;
          break;
      case  "Nanded":
          optionsList = Nanded;
          break;
      case "Hingoli":
          optionsList = Hingoli;
          break;
      case  "Parbhani":
          optionsList = Parbhani;
          break;
      case "Jalna":
          optionsList = Jalna;
          break;
      case  "Aurangabad":
          optionsList = aurangabad;
          break;
      case  "Beed":
          optionsList = Beed;
          break;
      case "Latur":
          optionsList = Latur ;
          break;
      case  "Osmanabad":
          optionsList = Osmanabad;
          break;
      case  "Solapur_North":
          optionsList = Solapur_North;
          break;
      case "Ahmednagar":
          optionsList = Ahmednagar;
          break;
      case  "Pune":
          optionsList = pune;
          break;
      case "Satara":
          optionsList = Satara;
          break;
      case  "Sangli":
          optionsList = Sangli;
          break;
      case "Kolhapur":
          optionsList = Kolhapur;
          break;

  }

  // console.log(optionsList)
    if(optionsList!=undefined){
        htmlString = htmlString+"<option value=''> Select Taluka </option>";
        for(var i = 1; i < optionsList.length; i++){
        htmlString = htmlString+"<option value='"+ optionsList[i] +"'>"+ optionsList[i] +"</option>";
        }
    }
    $("#block_s").html(htmlString);

  console.log('not')

  });

$('#block_s').change(function(){
    putWMSLayertaluka();
    var input={} 

if(taluka!=""){
    input.taluka = taluka;
}

$.ajax({
    type:"GET",
    url: "{% url 'tal_proj' %}",
    dataType: 'json',
    data: {input},
    success: function(data){
        //console.log(data)
        //d = JSON.parse(data["data"])
        //console.log(data['c1'])
        var htm = "<option value=''> Select Project</option>"
        data.pp.forEach(e=>{
            htm=htm+`<option value='${e.project}'>${e.project}</option>`
        })
        $('#project').html(htm)

    }
})
    document.getElementById('cate_submit').click();

    
    //document.getElementById('fs').click()
    //document.getElementById("post-form").submit();
})
{/*
$('#agan_type').change(function(){
    //formSubmit()
    document.getElementById('fs').click()
})

$('#construction').change(function(){
    //putWMSLayertaluka();
    document.getElementById('fs').click()
    //document.getElementById("post-form").submit();
})

$('#sitangan').change(function(){
    //putWMSLayertaluka();
    document.getElementById('fs').click()
    //document.getElementById("post-form").submit();
})

$('#cate_val1').change(function(){
    document.getElementById('fs').click()
})

$('#cate_val2').change(function(){
    document.getElementById('fs').click()
})

$('#cate_val3').change(function(){
    document.getElementById('fs').click()
})
*/}
function setView(layerName, selectedBoundary) {
    // if (area) {
    //     mymap.removeLayer(area);
    // }
    let rootUrl = 'https://geonode.communitygis.in/geoserver/geonode/ows';

    let options = {
        service: 'WFS',
        version: '1.0.0',
        request: 'GetFeature',
        outputFormat: 'application/json',
        typeName: layerName,
        cql_filter: `Block='${selectedBoundary}'`,
        propertyName: 'the_geom'
    };
    let parameters = L.Util.extend(options);
    layer_url = rootUrl + L.Util.getParamString(parameters)
    fetch(layer_url).then(
        function(response) {
            if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' +
                    response.status);
                return;
            }
            response.json().then(function(geojsonData) {
// <<<<<<< HEAD
                area = L.geoJson(geojsonData.features).addTo(mymap)
                let lat = area.getBounds()._northEast.lat
                let lng = area.getBounds()._northEast.lng
// =======
                //area = L.geoJson(geojsonData.features).addTo(mymap)
                area = L.geoJson(geojsonData.features)
                lat = area.getBounds()._northEast.lat
                lng = area.getBounds()._northEast.lng
// >>>>>>> 30823cbbe6b08aef56b6db3bfdbcdb2b805aa0ed
                mymap.setView([lat, lng - 0.4], 10)
            });
        }).catch(function(err) {
        console.log('Fetch Error :-S', err);
    });
}

function setViewByDistrict(layerName, state,district) {
    // if (area) {
    //     mymap.removeLayer(area);
    // }
    alert(layerName+state+district);
    var area = null
    let rootUrl = 'https://geonode.communitygis.in/geoserver/geonode/ows';

    let options = {
        service: 'WFS',
        version: '1.0.0',
        request: 'GetFeature',
        outputFormat: 'application/json',
        typeName: layerName,
        cql_filter: `District='${district}'`,
        propertyName: 'the_geom'
    };
    let parameters = L.Util.extend(options);
    layer_url = rootUrl + L.Util.getParamString(parameters)

    fetch(layer_url).then(
        function(response) {
            if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' +
                    response.status);
                return;
            }
            response.json().then(function(geojsonData) {
                area = L.geoJson(geojsonData.features)
                lat = area.getBounds()._northEast.lat
                lng = area.getBounds()._northEast.lng
                mymap.setView([lat - .5, lng - 0.9], 9)
            });
        }).catch(function(err) {
        console.log('Fetch Error :-S', err);
    });
}
function fetchJSON(url) {
    return fetch(url)
      .then(function(response) {
        return response.json();
      });
  }

  /*
var data = fetchJSON("{% static 'data/districts.geojson' %}")
            .then(function(data) { 

        // do what you want to do with `data` here...
        data.features.forEach(function(feature) {
                console.log(feature);
                var symbol = feature.properties['icon'];
                console.log(symbol);
            });

});
*/

function putWMSLayerdist() {
    var dist = document.getElementById('district').value;
    var state = 'Maharashtra';
    var layers = 'geonode:MH_block0';
    console.log(dist);
    //var stLayerLatLong= listState[indstate];
    if (dist == 'Mumbai City' || dist == 'Mumbai Suburban')
        mymap.setView([19.0760, 72.8777], 11);
    if (state == "Chhattisgarh") {
        layers = 'geonode:all_india_districts_11june2020';
    }
    //clear_distlayer();
    //clear_tallayer();
    var wms_layer = L.tileLayer.wms('https://geonode.communitygis.in/geoserver/wms', {
        layers: 'MH_block0',
        format: 'image/png',
        transparent: 'true',
        // version: '1.3.0',
        // cql_filter: `district='${dist}' AND state='${state}'`,
        cql_filter: `District='${dist}'`,
        style: ""
    });
    console.log(wms_layer);
    //clear_layer();
    //clearpoint_layer();
    wms_layer.addTo(mymap);
    setViewByDistrict('geonode:MH_block0', state,dist);

    //mymap.setView([stLayerLatLong[1],stLayerLatLong[2]],8);
    distLayerList.push(wms_layer);
    addWMSLegend(layers);


}
var taluka
  function putWMSLayertaluka() {
    // clear_tallayer();

    if(talLayer){
        mymap.removeLayer(talLayer)
    }
    taluka = document.getElementById('block_s').value;
    /*
    var dist = document.getElementById('district').value;
    var taluka = document.getElementById('block_s').value;

    var wms_layer = L.tileLayer.wms('https://geonode.communitygis.in/geoserver/wms', {
        layers: "geonode:MH_block0",
        // cql_filter: "taluka_nam='" + taluka + "'",
        cql_filter: `Block='${taluka}' AND District='${dist}'`,
        format: 'image/png',
        transparent: 'true',
        style: "color:red",
    });
    // clear_layer();
    //clear_tallayer();
    // console.log(wms_layer);
    wms_layer.addTo(mymap);
    setView('geonode:MH_block0', taluka);

    talLayer=wms_layer;
    // console.log(taluka);

*/
var wms_layer;
var data = fetchJSON("{% static 'data/talukas.geojson' %}")
    .then(function(data) { 

    // do what you want to do with `data` here...
    data.features.forEach(function(feature) {
        //console.log(feature.properties.Block)
        if(DistrictSelected!=""){
            if(feature.properties.Block==taluka && feature.properties.District==DistrictSelected){
                console.log(feature.geometry)
                wms_layer = L.geoJson(feature.geometry)
                wms_layer.addTo(mymap)
            }
        }else{
            if(feature.properties.Block==taluka){
                console.log(feature.geometry)
                wms_layer = L.geoJson(feature.geometry)
                wms_layer.addTo(mymap)
                mymap.fitBounds(wms_layer.getBounds() )
            }
        }
        talLayer=wms_layer;
    });
    
});   

}


{/*

$('#category_1').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} );
$('#category_2').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} );
$('#category_3').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} );
*/}



var d;
{/*
$(document).ready(
    $('#post-form').submit(async function(e){
        e.preventDefault();
        var serializedData = $(this).serialize();
        console.log('hjkhjh');

        $.ajax({
            type:"POST",
            url: "{% url 'map' %}",
            dataType: 'json',
            data: serializedData,
            success: function(data){
                //console.log(data["data"])
                d = JSON.parse(data["data"])
                plotData()
            }
        })
        console.log(' belowhjkhjh');
    }),

    $('#cate').submit(async function(e){
        e.preventDefault();
        var serializedData = $(this).serialize();

        $.ajax({
            type:"POST",
            url: "{% url 'category' %}",
            dataType: 'json',
            data: serializedData,
            success: function(data){
                //d = JSON.parse(data["data"])
                if(data.c1!=""){
                    document.getElementById('cate1').value = document.getElementById("category_1").value
                    //console.log(document.getElementById('cate1').value)
                    document.getElementById('cate_val1').style.display = 'block';
                    var htmlString="<option value='"+"'>"+ 'Select' +"</option>";

                    data.c1.forEach(e=>{
                        for(k in e)
                        htmlString = htmlString+"<option value='"+ e[k] +"'>"+ e[k] +"</option>";
                    })
                    $("#cate_val1").html(htmlString);

                }else{
                    document.getElementById('cate_val1').style.display = 'none';
                    $("#cate_val1").html("<option value='"+"'>"+ 'Select' +"</option>");
                    document.getElementById('cate_val1').value="";
                    document.getElementById('cate_val1').dispatchEvent(new Event('change'));
                }
                if(data.c2!=""){
                    document.getElementById('cate2').value = document.getElementById("category_2").value
                    document.getElementById('cate_val2').style.display = 'block';
                    var htmlString="<option value=''>"+ "Select" +"</option>";

                    data.c2.forEach(e=>{
                        for(k in e)
                            htmlString = htmlString+"<option value='"+ e[k] +"'>"+ e[k] +"</option>";
                    })
                    $("#cate_val2").html(htmlString);
                }else{
                    document.getElementById('cate_val2').style.display = 'none';
                    $("#cate_val2").html("<option value='"+"'>"+ 'Select' +"</option>");
                    document.getElementById('cate2').value=""
                    document.getElementById('cate_val2').dispatchEvent(new Event('change'));
                }
                if(data.c3!=""){
                    document.getElementById('cate3').value = document.getElementById("category_3").value
                    document.getElementById('cate_val3').style.display = 'block';
                    var htmlString="<option value='"+"'>"+ 'Select' +"</option>";

                    data.c3.forEach(e=>{
                        for(k in e)
                            htmlString = htmlString+"<option value='"+ e[k] +"'>"+ e[k] +"</option>";
                    })
                    $("#cate_val3").html(htmlString);
                }else{
                    document.getElementById('cate_val3').style.display = 'none';
                    $("#cate_val3").html("<option value='"+"'>"+ 'Select' +"</option>");
                    document.getElementById('cate3').value=""
                    document.getElementById('cate_val3').dispatchEvent(new Event('change'));
                }
                //console.log(data)
            }
        })
    })
) */}

{/* $('#category_1').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} ); */}

$('#cate_val1').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} );

{/* $('#category_2').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} ); */}

$('#cate_val2').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} );

{/* $('#category_3').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} ); */}

$('#cate_val3').change(function(){
    document.getElementById('cate_submit').click();
    //document.getElementById('fs').click()
} );

/*
function sortSelect(selElem) {
    var tmpAry = new Array();
    for (var i=0;i<selElem.options.length;i++) {
        tmpAry[i] = new Array();
        tmpAry[i][0] = selElem.options[i].text;
        tmpAry[i][1] = selElem.options[i].value;
    }
    tmpAry.sort();
    while (selElem.options.length > 0) {
        selElem.options[0] = null;
    }
    for (var i=0;i<tmpAry.length;i++) {
        var op = new Option(tmpAry[i][0], tmpAry[i][1]);
        selElem.options[i] = op;
    }
    return;
}
*/

function removeOptn(a,b){
    // console.log(document.getElementById(a).getElementsByTagName('input'))
    for(var i=0;i<document.getElementById(a).getElementsByTagName('input').length;i++){
        if(document.getElementById(a).getElementsByTagName('input')[i].checked){
            document.getElementById(a).getElementsByTagName('input')[i].checked=false;
            document.getElementById('cate_submit').click();
            break;
        }
    }
    document.getElementById('category_1').innerHTML+='<option value="'+a+'">'+b+'</option>';
    document.getElementById(a).remove()
    console.log(`${a} ${b}`)
    // document.getElementById('cate_submit').click();
    // sortSelect(document.getElementById('category_1'))
}

// var htm = "";
$(document).ready(
    $('#cate').submit(async function(e){
        e.preventDefault();
        var serializedData = $(this).serialize();
        //console.log('hjkhjh');

        $(document).ajaxStart(function () {
            document.getElementById('load').style.display='flex';
            //$("#load").show();
        }).ajaxStop(function () {
            document.getElementById('load').style.display='none';
            //$("#load").hide();
        });

        $.ajax({
            type:"POST",
            url: "{% url 'map' %}",
            dataType: 'json',
            data: serializedData,
            success: function(data){
                console.log(data["data"])
                // d = JSON.parse(data["data"])
                //console.log(d)
                d = data["data"]
                plotData()
            }
        })
        console.log(' belowhjkhjh');
    }),
    $('#category_1').on('change',function(){
        var category_1 = $('#category_1').val()
        $.ajax({
            type:"GET",
            url: "{% url 'category_1' %}",
            dataType: 'json',
            data: {category_1},
            success: function(data){
                //console.log(data["data"])
                //d = JSON.parse(data["data"])
                //console.log(data['c1'])
                if(data['c1']!=""){
                    document.getElementById('cate1').value = document.getElementById("category_1").value
                    // console.log(document.getElementById('cate1').value)
                    // document.getElementById('cate_val1').style.display = 'block';
                    /*
                    var htmlString="<option value=''>"+ 'Select' +"</option>";

                    data.c1.forEach(e=>{
                        for(k in e)
                        htmlString = htmlString+"<option value='"+ e[k] +"'>"+ e[k] +"</option>";
                    })
                    $("#cate_val1").html(htmlString);
                    */

                    var htm = "";
                    htm+=`<div id='`+document.getElementById('cate1').value+`'>`+document.getElementById("category_1").options[document.getElementById("category_1").selectedIndex].text+`<div class="cls" style=" border-radius: 50%; color: red;"><i  onclick='removeOptn("`+document.getElementById('cate1').value+`","`+document.getElementById("category_1").options[document.getElementById("category_1").selectedIndex].text+`")' class='fas fa-times fa-2x' style='float:right;'></i><span style="float: right; background-color: #c9dbe6; margin-right: 5px; color: black; border: #000 1px solid;" class="cls_txt">Close</span></div><br><br>`
                    data.c1.forEach(e=>{
                        for(k in e)
                        htm = htm+"<input type='checkbox' class='chkc-1' onchange='' name='"+document.getElementById("category_1").value+"__in' value="+e[k]+" id=''><label class='mx-2' for=''>"+e[k]+"</label><br>";
                    })
                    htm+='</div>'

                    document.getElementById('selected_optn').innerHTML+=htm;

                    // document.getElementById('chk-1').innerHTML=htm
                    $('.chkc-1').click(function(){
                        document.getElementById('cate_submit').click();
                    })
                    document.getElementById('category_1').remove(document.getElementById('category_1').selectedIndex)
                }else{
                    document.getElementById('chk-1').innerHTML=""
                    /*
                    document.getElementById('cate_val1').style.display = 'none';
                    $("#cate_val1").html("<option value='"+"'>"+ 'Select' +"</option>");
                    document.getElementById('cate_val1').value="";
                    document.getElementById('cate_val1').dispatchEvent(new Event('change'));
                    */
                }

            }
        })
        //console.log($('#category_1').val())
    }),

    $('#category_2').on('change',function(){
        var category_2 = $('#category_2').val()

        $.ajax({
            type:"GET",
            url: "{% url 'category_2' %}",
            dataType: 'json',
            data: {category_2},
            success: function(data){
                //console.log(data["data"])
                //d = JSON.parse(data["data"])
                //console.log(data['c1'])
                if(data['c2']!=""){
                    document.getElementById('cate2').value = document.getElementById("category_2").value
                    //console.log(document.getElementById('cate1').value)
                    // document.getElementById('cate_val2').style.display = 'block';
                    /*
                    var htmlString="<option value=''>"+ 'Select' +"</option>";

                    data.c2.forEach(e=>{
                        for(k in e)
                        htmlString = htmlString+"<option value='"+ e[k] +"'>"+ e[k] +"</option>";
                    })
                    $("#cate_val2").html(htmlString);
                    */
                    var htm = "";
                    data.c2.forEach(e=>{
                        for(k in e)
                        htm = htm+"<input type='checkbox' class='chkc-2' name='"+document.getElementById("category_2").value+"__in' value="+e[k]+" id=''><label class='mx-2' for=''>"+e[k]+"</label><br>";
                    })
                    document.getElementById('chk-2').innerHTML=htm
                    $('.chkc-2').click(function(){
                        document.getElementById('cate_submit').click();
                    })
                }else{
                    document.getElementById('chk-2').innerHTML=""
                    /*
                    document.getElementById('cate_val2').style.display = 'none';
                    $("#cate_val2").html("<option value='"+"'>"+ 'Select' +"</option>");
                    document.getElementById('cate_val2').value="";
                    document.getElementById('cate_val2').dispatchEvent(new Event('change'));
                    */
                }
                console.log('end')

            }
        })
        //console.log($('#category_1').val())
    }),

    $('#category_3').on('change',function(){
        var category_3 = $('#category_3').val()
        $.ajax({
            type:"GET",
            url: "{% url 'category_3' %}",
            dataType: 'json',
            data: {category_3},
            success: function(data){
                console.log(data)
                //d = JSON.parse(data["data"])
                //console.log(data['c1'])
                if(data['c3']!=""){
                    document.getElementById('cate3').value = document.getElementById("category_3").value
                    //console.log(document.getElementById('cate1').value)
                    // document.getElementById('cate_val3').style.display = 'block';
                    /*
                    var htmlString="<option value=''>"+ 'Select' +"</option>";

                    data.c3.forEach(e=>{
                        for(k in e)
                        htmlString = htmlString+"<option value='"+ e[k] +"'>"+ e[k] +"</option>";
                    })
                    $("#cate_val3").html(htmlString);
                    */
                    var htm = "";
                    data.c3.forEach(e=>{
                        for(k in e)
                        htm = htm+"<input type='checkbox' class='chkc-3' name='"+document.getElementById("category_3").value+"__in' value="+e[k]+" id=''><label class='mx-2' for=''>"+e[k]+"</label><br>";
                    })
                    document.getElementById('chk-3').innerHTML=htm
                    $('.chkc-3').click(function(){
                        document.getElementById('cate_submit').click();
                    })
                }else{
                    document.getElementById('chk-3').innerHTML=""
                    /*&
                    document.getElementById('cate_val3').style.display = 'none';
                    $("#cate_val3").html("<option value='"+"'>"+ 'Select' +"</option>");
                    document.getElementById('cate_val3').value="";
                    document.getElementById('cate_val3').dispatchEvent(new Event('change'));
                    */
                }

            }
        })
        //console.log($('#category_1').val())
    }),
    

)

function formSubmit(){
    document.getElementById("post-form").submit();
}


function plotData(){
    //for(x in d){
    //    console.log(d[x].fields.latitude)
    //}
    if(d==undefined || d == ""){
        //alert("No results for this selection")
        //clearAll()
    }
    console.log(`pltdata called`)
    replot()
    for(x in d){
        var point = L.marker([d[x].latitude,d[x].longitude],{icon:icon1});
        point.addTo(mymap)
        htm=""
        for (const key in d[x]) {
            if (d[x].hasOwnProperty(key)) {
                if(key!='latitude' & key!='longitude'){
                    htm = htm+`${key}: ${d[x][key]}<br>`
                }
            }
        }
        point.bindPopup(`<div  style="height:200px; overflow-y: scroll; background: white; color: black;">`+ htm+`</div`)
        //point.data=d[x].fields;
        //point.bindPopup(`<div>District: ${d[x].fields.district}<br>Taluka: ${d[x].fields.block_n}<br>Project: ${d[x].fields.project}<br>Beat: ${d[x].fields.beat}<br>AWC name: ${d[x].fields.anganwadi_field}<br></div>`)
        points.push(point)
    }
}

function clearAll(){

    DistrictSelected="";
    points.forEach(p=>{
        mymap.removeLayer(p)
    })
    points=[]
    if(districtLayer){
        mymap.removeLayer(districtLayer)
    }
    document.getElementById('district').value = "";
    if(talLayer){
        mymap.removeLayer(talLayer)
    }
    document.getElementById('block_s').value = "";
    document.getElementById('project').value = "";

    var htm = '<option value=""> Select Taluka </option>'
                '{% for i in taluka %}'
                htm=htm+'<option value='+'{{ i.block_n }}'+'>{{ i.block_n }}</option>'
                '{% endfor %}'
            $('#block_s').html(htm)

    document.getElementById('category_1').value=""

    // console.log(document.getElementById('cate').getElementsByTagName('input'))
    for(var i=0;i<document.getElementById('cate').getElementsByTagName('input').length;i++){
        if(document.getElementById('cate').getElementsByTagName('input')[i].checked){
            document.getElementById('cate').getElementsByTagName('input')[i].checked=false;
        }
    }

    //document.getElementById('cate1').value=""
    // document.getElementById('chk-1').innerHTML=""
    /*
    document.getElementById('category_2').value=""
    //document.getElementById('cate2').value=""
    document.getElementById('chk-2').innerHTML=""
    document.getElementById('category_3').value=""
    //document.getElementById('cate3').value=""
    document.getElementById('chk-3').innerHTML=""
    */
    

    //document.getElementById('cate_val1').style.display = 'none';
    //$("#cate_val1").html("<option value='"+"'>"+ 'Select' +"</option>");
    //document.getElementById('cate_val1').value="";

    //document.getElementById('cate_val2').style.display = 'none';
    //$("#cate_val2").html("<option value='"+"'>"+ 'Select' +"</option>");
    //document.getElementById('cate_val2').value="";

    //document.getElementById('cate_val3').style.display = 'none';
    //$("#cate_val3").html("<option value='"+"'>"+ 'Select' +"</option>");
    //document.getElementById('cate_val3').value="";
    mymap.setView([19.000, 74.999],7);


}

function replot(){
    points.forEach(p=>{
        mymap.removeLayer(p)
    })
    points=[]

}

function funct(){
    console.log('sfsdfsdf')
    document.getElementById('post-form').submit()

}

      </script>



  {% endblock %}
